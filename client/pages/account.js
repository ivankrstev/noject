import styles from "@/styles/Account.module.css";
import Pic from "@/public/icons/photo.jpg";
import { Fragment, useState } from "react";
import Head from "next/head";
import Navbar from "@/components/Navbar";
import { QRCodeCanvas } from "qrcode.react";
import Modal from "react-modal";
import Image from "next/image";
import CloseIcon from "@/public/icons/close.svg";

export default function account() {
  const [tfaPage, setTfaPage] = useState(1);
  const [openModal, setOpenModal] = useState(false);
  const [toggleTwoFactorAuth, setToggleTwoFactorAuth] = useState(true);
  const [verifiedEmail, setVerifiedEmail] = useState(false);

  return (
    <Fragment>
      <Head>
        <title>My account - Noject</title>
      </Head>
      <Navbar showSidebar={true} showBtnDashboard={true} />
      <div className={styles.account}>
        <div className={styles.profileInfo}>
          <img src={Pic.src} alt='Profile Picture' />
          <input
            type='file'
            hidden
            accept='image/*'
            multiple={false}
            onChange={(e) => {
              if (e.target.files[0]) console.log(e.target.files);
            }}
          />
          <button
            onClick={(e) => {
              e.target.previousSibling.click();
            }}>
            Change Picture
          </button>
          <h3>Ivan Krstev</h3>
          <p>ivankrstev246@gmail.com</p>
          <p>Created at: </p>
        </div>
        <form className={styles.changeEmailForm}>
          <p>Your email is {verifiedEmail ? "verified." : "not verified."}</p>
          {!verifiedEmail && (
            <button
              onClick={(e) => {
                e.preventDefault();
              }}>
              Send confirmation link
            </button>
          )}
          <label htmlFor='changeEmail'>Change email address:</label>
          <input id='changeEmail' type='email' placeholder='Enter your new email address' />
          <button
            onClick={(e) => {
              e.preventDefault();
            }}>
            Send email link
          </button>
        </form>
        <form className={styles.changePasswordForm}>
          <h4>Change your password</h4>
          <label htmlFor='current-password'>Current password:</label>
          <input
            id='current-password'
            required
            type='password'
            placeholder='Enter your old password'
          />
          <label htmlFor='new-password'>New password:</label>
          <input
            required
            minLength={8}
            id='new-password'
            type='password'
            placeholder='Enter your new password'
          />
          <label htmlFor='confirm-password'>Confirm password:</label>
          <input
            minLength={8}
            required
            id='confirm-password'
            type='password'
            placeholder='Reenter your new password'
          />
          <button
            onClick={(e) => {
              e.preventDefault();
            }}>
            Change password
          </button>
        </form>
        <div className={styles.twoFactorAuth}>
          <p>
            Two Factor Authentication is {toggleTwoFactorAuth ? "enabled" : "disabled"}
            {". "}
            <button className={styles.toggleTwoFactorAuthBtn} onClick={() => setOpenModal(true)}>
              {toggleTwoFactorAuth ? "Disable" : "Enable"}
            </button>
          </p>
          <Modal className={styles.twoFactorModal} isOpen={openModal}>
            <div className={styles.scanQrCode}>
              <div className={styles.scanQrCodeHeader}>
                <h3>
                  {toggleTwoFactorAuth
                    ? "Enable two-factor authentication"
                    : "Disable two-factor authentication"}
                </h3>
                <button onClick={() => setOpenModal(false)}>
                  <Image src={CloseIcon} alt='Close Modal' width={30} />
                </button>
              </div>
              {tfaPage === 1 && (
                <Fragment>
                  <div className={styles.qrCodeImg}>
                    <QRCodeCanvas value='F1LPCLXF795RENEH' />
                  </div>
                  <p>
                    Scan the QR code or manually enter the following code:{" "}
                    <span>F1LPCLXF795RENEH</span>
                  </p>
                  <button className={styles.complete2FABtn} onClick={() => setTfaPage(2)}>
                    Continue
                  </button>
                </Fragment>
              )}
              {tfaPage === 2 && (
                <Fragment>
                  <label>Enter the code generated by your authentication app.</label>
                  <input type='text' />
                  <div className={styles.twoFactorFormButtons}>
                    {toggleTwoFactorAuth && (
                      <button
                        style={{
                          backgroundColor: "grey",
                          borderColor: "grey",
                          marginRight: "0.3em",
                        }}
                        className={styles.complete2FABtn}
                        onClick={() => setTfaPage(1)}>
                        Go Back
                      </button>
                    )}
                    <button className={styles.complete2FABtn}>Verify</button>
                  </div>
                </Fragment>
              )}
            </div>
          </Modal>
        </div>
      </div>
    </Fragment>
  );
}
